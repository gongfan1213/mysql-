为了帮助你系统性地复习，我梳理了Redis的核心面试考点，并整合成了一份详细的复习指南。下面的表格汇总了Java面试中Redis的常见考查方向和高频问题，你可以用它来快速检验自己的掌握情况。

| 考查方向     | 核心考点与高频面试题                                                                                                                               |
| :----------- | :------------------------------------------------------------------------------------------------------------------------------------------------- |
| **基础概念**   | Redis特点、单线程与高性能原理、多数据结构及使用场景                                      |
| **持久化**     | RDB与AOF原理及对比、持久化策略选择、AOF重写                                                                      |
| **高可用集群** | 主从复制原理、哨兵模式（Sentinel）、Redis Cluster分片                                                              |
| **数据管理**   | 过期策略（惰性删除+定期删除）、内存淘汰策略                                                                          |
| **缓存问题**   | 缓存穿透/击穿/雪崩及解决方案、缓存与数据库双写一致性                                                              |
| **分布式锁**   | 基于Redis的实现、RedLock算法争议、看门狗机制                                                                    |
| **实战与优化** | 大Key与热点Key处理、管道（Pipeline）、内存碎片整理                                                                              |

下面是针对一些核心问题的详细解析和回答思路，可以帮你更好地组织面试时的语言。

### 🔥 核心问题详解

#### **Redis为什么单线程还这么快？**
这是一个经典问题，你需要清晰地阐述以下几点：
- **内存操作**：数据存储在内存中，读写速度极快。
- **I/O多路复用**：使用epoll等机制，单线程可以高效处理大量并发连接。
- **单线程优势**：避免了多线程的上下文切换和竞争锁的开销。
> **注意**：需要指出Redis的"单线程"通常指的是处理命令的核心模块。在6.0及以上版本，一些I/O操作等已由后台线程处理，以提升性能。

#### **缓存穿透、击穿、雪崩的区别与解决方案**
这是面试必考的组合题，务必理清三者的区别。
- **缓存穿透**
    - **问题**：请求数据库中**根本不存在**的数据，导致每次请求都直达数据库。
    - **解决方案**：
        1. **缓存空对象**：将查询为空的结果也缓存起来，并设置一个较短的过期时间。
        2. **布隆过滤器**：在缓存之前加一层布隆过滤器，快速判断数据是否存在，拦截不存在的数据请求。
- **缓存击穿**
    - **问题**：一个**热点Key**在过期瞬间，大量请求击穿缓存，直接访问数据库。
    - **解决方案**：
        1. **互斥锁**：只有一个请求能获取到锁并去数据库加载数据，其他请求等待。
        2. **逻辑过期**：不设置物理过期时间，而是将过期时间存储在Value中。发现快过期时，异步刷新缓存。
- **缓存雪崩**
    - **问题**：同一时间**大量Key集中过期**，或**Redis服务宕机**，导致所有请求涌向数据库。
    - **解决方案**：
        1. **分散过期时间**：给缓存Key的过期时间加上随机值，避免同时过期。
        2. **高可用架构**：搭建Redis集群，如哨兵模式或Cluster模式，避免单点故障。
        3. **服务降级与熔断**：在非核心业务出现缓存雪崩时，进行服务降级或熔断，保护核心业务和数据库。

#### **如何用Redis实现分布式锁？**
你需要掌握基础实现和进阶问题。
- **基础实现**：使用 `SET key value NX PX timeout` 命令，保证**原子性**地获取锁并设置超时时间，防止死锁。
- **避免误删**：Value应存储唯一标识（如UUID+线程ID），在删除锁时通过Lua脚本进行验证，确保只能删除自己加的锁。
- **锁续期（看门狗）**：如果业务执行时间可能超过锁的超时时间，需要有一个机制来定时续期。可以提到Redisson库中的看门狗机制就是为此而生。
- **集群问题**：在Redis主从架构中，主节点宕机可能导致锁丢失。可以简要提及RedLock算法及其争议，并说明在要求强一致性的场景下，ZooKeeper可能是更好的选择。

#### **RDB和AOF持久化对比**
- **RDB**：在特定时间点生成数据的**快照**。优点是文件小、恢复快；缺点是可能丢失最后一次快照后的数据。
- **AOF**：记录**每一条写命令**。优点是数据安全性高，最多丢失一秒数据；缺点是文件大、恢复慢。
- **生产建议**：通常**两者结合使用**（Redis 4.0后支持混合持久化），利用RDB做冷备，利用AOF保证数据安全性。

### 💡 面试准备小贴士
- **理解原理**：不仅要知其然，还要知其所以然。例如，被问到数据结构时，能说出其底层实现（如SDS、跳跃表）和典型应用场景。
- **结合项目**：准备一两个你在项目中实际使用Redis的例子，讲清楚场景、选型依据和可能遇到的问题。
- **保持自信**：如果遇到一时答不上的问题，可以坦诚说明，并尝试给出自己的分析思路，这往往比直接说"不知道"要好。

希望这份复习指南能帮助你顺利通过面试！如果你对某个具体问题还想进行更深入的探讨，可以随时再问我。
